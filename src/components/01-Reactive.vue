<template>
  <div class="demo-container">
    <h2>1ï¸âƒ£ å“åº”å¼ç³»ç»Ÿ</h2>
    <p class="intro">Vue3 ä½¿ç”¨ Proxy å®ç°å“åº”å¼ç³»ç»Ÿï¼Œä¸»è¦é€šè¿‡ ref å’Œ reactive åˆ›å»ºå“åº”å¼æ•°æ®</p>

    <div class="demo-section">
      <h3>ğŸ“Œ ref - åŸºæœ¬ç±»å‹å“åº”å¼</h3>
      <div class="code-demo">
        <div class="demo-box">
          <p>è®¡æ•°å™¨: <strong>{{ count }}</strong></p>
          <button @click="increment">å¢åŠ </button>
          <button @click="decrement">å‡å°‘</button>
          <button @click="reset">é‡ç½®</button>
        </div>
        <div class="code-explanation">
          <h4>ğŸ’¡ è¯´æ˜ï¼š</h4>
          <ul>
            <li><code>ref()</code> ç”¨äºåˆ›å»ºåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®</li>
            <li>åœ¨ JS ä¸­è®¿é—®éœ€è¦ <code>.value</code></li>
            <li>åœ¨æ¨¡æ¿ä¸­ä¼šè‡ªåŠ¨è§£åŒ…ï¼Œä¸éœ€è¦ <code>.value</code></li>
            <li>ä¿®æ”¹å€¼ä¼šè‡ªåŠ¨è§¦å‘è§†å›¾æ›´æ–°</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“Œ reactive - å¯¹è±¡ç±»å‹å“åº”å¼</h3>
      <div class="code-demo">
        <div class="demo-box">
          <p>ç”¨æˆ·ä¿¡æ¯:</p>
          <div class="user-info">
            <p>å§“å: <strong>{{ user.name }}</strong></p>
            <p>å¹´é¾„: <strong>{{ user.age }}</strong></p>
            <p>èŒä½: <strong>{{ user.job }}</strong></p>
          </div>
          <button @click="updateUser">æ›´æ–°ä¿¡æ¯</button>
          <button @click="incrementAge">å¹´é¾„+1</button>
        </div>
        <div class="code-explanation">
          <h4>ğŸ’¡ è¯´æ˜ï¼š</h4>
          <ul>
            <li><code>reactive()</code> ç”¨äºåˆ›å»ºå¯¹è±¡çš„å“åº”å¼æ•°æ®</li>
            <li>ç›´æ¥è®¿é—®å±æ€§ï¼Œä¸éœ€è¦ <code>.value</code></li>
            <li>åªèƒ½ç”¨äºå¯¹è±¡ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„ï¼‰</li>
            <li>ä¿®æ”¹å±æ€§ä¼šè‡ªåŠ¨è§¦å‘è§†å›¾æ›´æ–°</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“Œ toRef å’Œ toRefs</h3>
      <div class="code-demo">
        <div class="demo-box">
          <p>äº§å“åç§°: <strong>{{ productName }}</strong></p>
          <p>äº§å“ä»·æ ¼: <strong>{{ productPrice }}</strong></p>
          <button @click="updateProduct">æ›´æ–°äº§å“</button>
        </div>
        <div class="code-explanation">
          <h4>ğŸ’¡ è¯´æ˜ï¼š</h4>
          <ul>
            <li><code>toRef</code> å°†å“åº”å¼å¯¹è±¡çš„å•ä¸ªå±æ€§è½¬ä¸º ref</li>
            <li><code>toRefs</code> å°†å“åº”å¼å¯¹è±¡çš„æ‰€æœ‰å±æ€§è½¬ä¸º ref</li>
            <li>ä¿æŒä¸åŸå¯¹è±¡çš„å“åº”å¼è¿æ¥</li>
            <li>å¸¸ç”¨äºè§£æ„å“åº”å¼å¯¹è±¡</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h3>ğŸ“Œ å“åº”å¼æ•°ç»„æ“ä½œ</h3>
      <div class="code-demo">
        <div class="demo-box">
          <div class="list-container">
            <div v-for="item in items" :key="item.id" class="list-item">
              {{ item.name }}
            </div>
          </div>
          <button @click="addItem">æ·»åŠ é¡¹ç›®</button>
          <button @click="removeItem">åˆ é™¤é¡¹ç›®</button>
          <button @click="updateFirstItem">æ›´æ–°ç¬¬ä¸€é¡¹</button>
        </div>
        <div class="code-explanation">
          <h4>ğŸ’¡ è¯´æ˜ï¼š</h4>
          <ul>
            <li>æ•°ç»„çš„å˜æ›´æ–¹æ³•ï¼ˆpushã€popã€shift ç­‰ï¼‰ä¼šè§¦å‘æ›´æ–°</li>
            <li>ç›´æ¥ä¿®æ”¹ç´¢å¼•ä¹Ÿä¼šè§¦å‘æ›´æ–°ï¼ˆVue3 æ”¹è¿›ï¼‰</li>
            <li>æ›¿æ¢æ•´ä¸ªæ•°ç»„ä¹Ÿä¼šè§¦å‘æ›´æ–°</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="code-block">
      <h3>ğŸ“ æ ¸å¿ƒä»£ç ç¤ºä¾‹</h3>
      <pre><code>import { ref, reactive, toRef, toRefs } from 'vue'

// 1. ref - åŸºæœ¬ç±»å‹
const count = ref(0)
count.value++  // åœ¨ JS ä¸­éœ€è¦ .value

// 2. reactive - å¯¹è±¡ç±»å‹
const user = reactive({
  name: 'å¼ ä¸‰',
  age: 25
})
user.age++  // ç›´æ¥è®¿é—®å±æ€§

// 3. toRef - å•ä¸ªå±æ€§è½¬ ref
const name = toRef(user, 'name')
name.value = 'æå››'  // ä¼šåŒæ­¥æ›´æ–° user.name

// 4. toRefs - æ‰€æœ‰å±æ€§è½¬ ref
const { name, age } = toRefs(user)
name.value = 'ç‹äº”'  // ä¿æŒå“åº”å¼</code></pre>
    </div>

    <div class="tips-box">
      <h3>ğŸ¯ æœ€ä½³å®è·µ</h3>
      <ul>
        <li><strong>åŸºæœ¬ç±»å‹ç”¨ refï¼š</strong>æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ç­‰</li>
        <li><strong>å¯¹è±¡ç±»å‹ç”¨ reactiveï¼š</strong>å¯¹è±¡ã€æ•°ç»„ç­‰</li>
        <li><strong>è§£æ„æ—¶ç”¨ toRefsï¼š</strong>ä¿æŒå“åº”å¼è¿æ¥</li>
        <li><strong>æ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ…ï¼š</strong>ref åœ¨æ¨¡æ¿ä¸­ä¸éœ€è¦ .value</li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, toRef, toRefs } from 'vue'

const count = ref(0)

const increment = () => {
  count.value++
  console.log('count å¢åŠ :', count.value)
}

const decrement = () => {
  count.value--
  console.log('count å‡å°‘:', count.value)
}

const reset = () => {
  count.value = 0
  console.log('count é‡ç½®:', count.value)
}

const user = reactive({
  name: 'å¼ ä¸‰',
  age: 25,
  job: 'åç«¯å·¥ç¨‹å¸ˆ'
})

const updateUser = () => {
  user.name = 'æå››'
  user.age = 28
  user.job = 'å…¨æ ˆå·¥ç¨‹å¸ˆ'
  console.log('ç”¨æˆ·ä¿¡æ¯æ›´æ–°:', user)
}

const incrementAge = () => {
  user.age++
  console.log('å¹´é¾„å¢åŠ :', user.age)
}

const product = reactive({
  name: 'Vue3 æ•™ç¨‹',
  price: 99
})

const productName = toRef(product, 'name')
const productPrice = toRef(product, 'price')

const updateProduct = () => {
  productName.value = 'Vue3 è¿›é˜¶æ•™ç¨‹'
  productPrice.value = 199
  console.log('äº§å“æ›´æ–°:', product)
}

const items = ref([
  { id: 1, name: 'é¡¹ç›® 1' },
  { id: 2, name: 'é¡¹ç›® 2' },
  { id: 3, name: 'é¡¹ç›® 3' }
])

let nextId = 4

const addItem = () => {
  items.value.push({ id: nextId++, name: `é¡¹ç›® ${nextId - 1}` })
  console.log('æ·»åŠ é¡¹ç›®:', items.value)
}

const removeItem = () => {
  if (items.value.length > 0) {
    items.value.pop()
    console.log('åˆ é™¤é¡¹ç›®:', items.value)
  }
}

const updateFirstItem = () => {
  if (items.value.length > 0) {
    items.value[0].name = 'å·²æ›´æ–°çš„é¡¹ç›®'
    console.log('æ›´æ–°ç¬¬ä¸€é¡¹:', items.value[0])
  }
}
</script>

<style scoped>
.demo-container {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

h2 {
  color: #667eea;
  margin-bottom: 1rem;
  font-size: 2rem;
}

.intro {
  color: #666;
  font-size: 1.1rem;
  margin-bottom: 2rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
  border-left: 4px solid #667eea;
}

.demo-section {
  margin: 2rem 0;
  padding: 1.5rem;
  background: #f8f9fa;
  border-radius: 8px;
}

.demo-section h3 {
  color: #333;
  margin-bottom: 1rem;
}

.code-demo {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-top: 1rem;
}

.demo-box {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.demo-box p {
  margin: 0.5rem 0;
  color: #555;
}

.demo-box strong {
  color: #667eea;
  font-size: 1.2rem;
}

.demo-box button {
  margin: 0.5rem 0.5rem 0 0;
  padding: 0.6rem 1.2rem;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.95rem;
  transition: all 0.3s;
}

.demo-box button:hover {
  background: #5568d3;
  transform: translateY(-2px);
}

.user-info {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 6px;
  margin: 1rem 0;
}

.list-container {
  max-height: 200px;
  overflow-y: auto;
  margin: 1rem 0;
}

.list-item {
  padding: 0.8rem;
  background: #f8f9fa;
  margin: 0.5rem 0;
  border-radius: 6px;
  border-left: 3px solid #667eea;
}

.code-explanation {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.code-explanation h4 {
  color: #667eea;
  margin-bottom: 1rem;
}

.code-explanation ul {
  list-style: none;
  padding: 0;
}

.code-explanation li {
  padding: 0.5rem 0;
  color: #555;
  line-height: 1.6;
}

.code-explanation code {
  background: #f8f9fa;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  color: #667eea;
  font-family: 'Courier New', monospace;
}

.code-block {
  margin: 2rem 0;
  background: #2d3748;
  padding: 1.5rem;
  border-radius: 8px;
  overflow-x: auto;
}

.code-block h3 {
  color: white;
  margin-bottom: 1rem;
}

.code-block pre {
  margin: 0;
}

.code-block code {
  color: #a0aec0;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  line-height: 1.6;
}

.tips-box {
  background: #fff3cd;
  padding: 1.5rem;
  border-radius: 8px;
  border-left: 4px solid #ffc107;
  margin-top: 2rem;
}

.tips-box h3 {
  color: #856404;
  margin-bottom: 1rem;
}

.tips-box ul {
  list-style: none;
  padding: 0;
}

.tips-box li {
  padding: 0.5rem 0;
  color: #856404;
}

.tips-box strong {
  color: #533f03;
}

@media (max-width: 768px) {
  .code-demo {
    grid-template-columns: 1fr;
  }
}
</style>
